+++
date = 2023-01-22T15:56:32Z
canonical = "https://social.rossabaker.com/users/ross/statuses/109733674485760332"
tags = [ "haskell", "scala", "fp" ]
+++

<p>The concept of &quot;monadic profunctors&quot;¹ for codecs is beautiful:</p><p>```<br />data Codec r w c a = Codec<br />  { codecIn :: r a,<br />    codecOut :: c → w a<br />  }<br />```</p><p>A parser `r a` may have expensive optimizations in its functor ops (run once) and then fast on each parse.  Printer `w a` may be the same, but depends on input `c`, and must be recreated on each run.</p><p>In my Scala port, performance is great on parse and crap on print. What am I missing?</p><p>¹ <a href="https://arxiv.org/pdf/1902.06950.pdf" target="_blank" rel="nofollow noopener noreferrer"><span class="invisible">https://</span><span class="">arxiv.org/pdf/1902.06950.pdf</span><span class="invisible"></span></a></p><p><a href="https://social.rossabaker.com/tags/Haskell" class="mention hashtag" rel="tag">#<span>Haskell</span></a> <a href="https://social.rossabaker.com/tags/Scala" class="mention hashtag" rel="tag">#<span>Scala</span></a> <a href="https://social.rossabaker.com/tags/FP" class="mention hashtag" rel="tag">#<span>FP</span></a></p>
